# FreeFighter - Android приложение

Браузерная игра-симулятор боя для Android на базе Capacitor.

## Описание игры

FreeFighter — однопользовательская игра-симулятор боя, основанная на механике выбора из трех вариантов атаки и защиты. Игрок соревнуется с компьютерным противником, предугадывая его действия и планируя свои собственные.

### Основная механика

- Игрок и противник выбирают последовательности из трех действий
- Каждое действие может быть направлено на три зоны: верх (голова), середина (тело), низ (ноги)
- Атакующий выбирает зону для удара, защищающийся — зону для блока
- Успешный удар наносит урон, заблокированный удар игнорируется
- Начальное здоровье: 12 HP у каждого бойца
- Каждый незаблокированный удар отнимает 1 HP
- При достижении 0 HP боец проигрывает
- При одновременном обнулении здоровья обоих бойцов играется дополнительный раунд с 2 HP у каждого

## Быстрый старт

### 1. Установка зависимостей

```bash
npm install
```

### 2. Разработка и тестирование в браузере

Запустите локальный сервер для разработки:

```bash
npm run dev
```

Откройте браузер по адресу: http://localhost:8080

**Важно:** Все изменения делайте в исходных файлах в корне проекта:
- `index.html`
- `game.js`
- `styles.css`
- `pics/` - изображения
- `icons/` - иконки приложения

### 3. Синхронизация с Android-проектом

После внесения изменений в веб-код, синхронизируйте их с Android-проектом:

```bash
npm run build
```

Или вручную:
```bash
npm run copy-assets
npm run sync:android
```

### 4. Тестирование на Android

#### Вариант 1: Через Android Studio (рекомендуется)

1. Откройте Android-проект:
```bash
npm run open:android
```

2. В Android Studio:
   - Подождите, пока проект загрузится
   - Подключите Android-устройство или запустите эмулятор
   - Нажмите кнопку "Run" (зеленая стрелка) или `Shift+F10`

#### Вариант 2: Через командную строку (требует настройки ADB)

```bash
cd android
./gradlew installDebug
```

### 5. Сборка APK

#### Debug APK (для тестирования)

```bash
cd android
./gradlew assembleDebug
```

APK файл будет в: `android/app/build/outputs/apk/debug/app-debug.apk`

#### Release APK (для публикации)

1. Настройте подпись приложения в Android Studio
2. Соберите release версию через Android Studio: `Build > Generate Signed Bundle / APK`

## Структура проекта

```
FreeFighter_web/
├── index.html              # Главная HTML страница
├── game.js                 # Логика игры
├── styles.css              # Стили
├── manifest.json           # PWA манифест
├── capacitor.config.json   # Конфигурация Capacitor
├── package.json            # NPM зависимости и скрипты
├── pics/                   # Изображения игры
├── icons/                  # Иконки приложения (PNG и SVG)
├── scripts/                # Вспомогательные скрипты
│   ├── copy-assets.js      # Копирование файлов в www
│   ├── generate-icons.js   # Генерация SVG иконок
│   └── generate-png-icons.js # Генерация PNG иконок
├── tests/                  # Тесты (структура для будущих тестов)
├── www/                    # Скомпилированные веб-ресурсы (автоматически)
└── android/                # Android-проект (автоматически)
```

## Команды

| Команда | Описание |
|---------|----------|
| `npm run dev` | Запуск локального сервера для разработки |
| `npm run build` | Копирование файлов и синхронизация с Android |
| `npm run copy-assets` | Только копирование файлов в www |
| `npm run sync:android` | Только синхронизация с Android-проектом |
| `npm run open:android` | Открыть Android-проект в Android Studio |

## Генерация иконок

Если нужно перегенерировать иконки:

```bash
# Генерация SVG иконок
node scripts/generate-icons.js

# Генерация PNG иконок (требует canvas)
node scripts/generate-png-icons.js
```

## Требования

- **Node.js** 16+ (для работы с npm и Capacitor)
- **Android Studio** (для сборки APK и эмулятора)
- **Java JDK** (обычно идет с Android Studio)

## Важные замечания

1. **Всегда редактируйте исходные файлы** в корне проекта, а не в папке `www/`
2. **После изменений** выполняйте `npm run build` для синхронизации
3. **Тестирование** происходит в браузере - Android Studio нужен только для финальной проверки
4. **Папки `www/` и `android/`** генерируются автоматически, не редактируйте их вручную

## Устранение проблем

### Ошибка "webDir is not valid"
Убедитесь, что в `capacitor.config.json` указан `"webDir": "www"`

### Изменения не отображаются в приложении
Выполните `npm run build` для синхронизации изменений

### Ошибки при сборке APK
1. Убедитесь, что Android Studio установлен и настроен
2. Проверьте, что Android SDK установлен
3. Попробуйте очистить проект: `cd android && ./gradlew clean`

## Тестирование

### Android тесты

Android тесты находятся в:
- `android/app/src/test/` - Unit тесты
- `android/app/src/androidTest/` - Instrumented тесты

Запуск тестов:
```bash
cd android
./gradlew test          # Unit тесты
./gradlew connectedAndroidTest  # Instrumented тесты (требует устройство/эмулятор)
```

### Веб тесты

Структура для веб-тестов подготовлена в папке `tests/`. Можно добавить тесты для логики игры.

## Следующие шаги

После успешной сборки можно:
- Добавить вибрацию при ударах
- Добавить звуковые эффекты
- Настроить подпись для публикации в Google Play
- Добавить аналитику
- Оптимизировать производительность
- Добавить веб-тесты для логики игры

