# План проекта FreeFighter

## Описание игры

FreeFighter — браузерная однопользовательская игра-симулятор боя, основанная на механике выбора из трех вариантов атаки и защиты. Игрок соревнуется с компьютерным противником, предугадывая его действия и планируя свои собственные.

## Основная механика

### Принцип игры
- Игрок и противник выбирают последовательности из трех действий
- Каждое действие может быть направлено на три зоны: верх (голова), середина (тело), низ (ноги)
- Атакующий выбирает зону для удара, защищающийся — зону для блока
- Успешный удар наносит урон, заблокированный удар игнорируется

### Структура раунда
Раунд состоит из двух фаз:
1. **Фаза атаки игрока**: Игрок атакует, противник защищается
2. **Фаза атаки противника**: Противник атакует, игрок защищается

Фазы выполняются последовательно, с визуализацией каждого действия.

### Система здоровья
- Начальное здоровье: 12 HP у каждого бойца
- Каждый незаблокированный удар отнимает 1 HP
- При достижении 0 HP боец проигрывает
- При одновременном обнулении здоровья обоих бойцов играется дополнительный раунд с 2 HP у каждого

## Компоненты игры

### Интерфейс игрока
- **Кнопки выбора**: Три кнопки для выбора зоны (верх/середина/низ)
- **Индикатор выбора**: Отображение выбранной последовательности из трех действий
- **Индикатор фазы**: Подсказка о том, что нужно выбрать (атаки или блоки)

### Визуализация бойцов
- **Полоски здоровья**: Визуальное отображение текущего HP с четкими делениями
- **Область действий**: Отображение текущего действия бойца (удар или блок)
- **Визуальная обратная связь**: Текст "HIT" при успешном ударе, "BLOCK!" при блокировании

### Управление игрой
- **Кнопка рестарта**: Возможность начать новую игру после окончания
- **Экран результата**: Отображение победы или поражения

## Игровой процесс

### Этап выбора
1. Игрок видит три активные кнопки
2. Нажимает кнопки в любом порядке для формирования последовательности из трех действий
3. После выбора трех действий начинается выполнение фазы

### Этап выполнения
1. Последовательно выполняются все три действия выбранной фазы
2. Каждое действие отображается визуально с соответствующей картинкой
3. Результат каждого действия (попадание или блок) отображается текстом
4. Здоровье обновляется после каждого попадания

### Переход между фазами
- После завершения первой фазы раунда начинается вторая
- После завершения обеих фаз раунда проверяется состояние здоровья
- Если игра продолжается, начинается новый раунд с чередованием ролей

## Визуальные элементы

### Изображения действий
- **Удары**: Три различных изображения для ударов по верхней, средней и нижней зонам
- **Блоки**: Три различных изображения для блоков верхней, средней и нижней зон
- **Отражение**: Изображения противника отображаются зеркально для создания эффекта противостояния

### Анимация и обратная связь
- Статичное отображение действий с текстовыми индикаторами результата
- Плавные переходы между состояниями
- Визуальное выделение выбранных кнопок

## Логика противника

Перед началом игры игрок может выбрать один из трех типов личности противника:

### Рандомный
Противник использует полностью случайный выбор действий для атак и блоков, что делает игру непредсказуемой и требует от игрока стратегического мышления.

### Упорный
Противник склонен повторять одинаковые действия. Первое действие выбирается случайно, а для каждого последующего действия с вероятностью 70% повторяется предыдущее действие, и с вероятностью 30% выбирается случайное действие.

### Адаптивный
Противник анализирует паттерны поведения игрока и адаптирует свою стратегию для противодействия им. Это самый сложный тип противника.

#### Механизм работы адаптивного AI

**Сбор статистики:**
- Анализатор паттернов собирает все атаки и блоки игрока с начала боя
- Хранит последние 5 последовательностей атак и последние 5 последовательностей блоков
- Статистика сбрасывается при начале новой игры

**Минимальный порог для активации:**
- Анализ паттернов активируется только после 3+ раундов игры
- До этого момента противник использует случайную стратегию

**Типы анализируемых паттернов:**

1. **Преобладание зоны (>50%):**
   - Если игрок атакует одну зону более чем в 50% случаев
   - Если игрок защищает одну зону более чем в 50% случаев
   - Сила паттерна определяется процентом:
     - **Слабый паттерн**: 50-70% (используется с весом 60%)
     - **Сильный паттерн**: >70% (используется с весом 80%)

2. **Повторяющиеся последовательности:**
   - Если игрок повторяет одну и ту же последовательность из 3 действий 2+ раза
   - Сила паттерна определяется количеством повторов:
     - **Слабый паттерн**: 2-3 повтора (используется с весом 60%)
     - **Сильный паттерн**: 4+ повтора (используется с весом 80%)

**Логика использования паттернов:**

**При защите противника (игрок атакует):**
- **Приоритет 1**: Если обнаружена повторяющаяся последовательность атак игрока
  - Противник блокирует эту последовательность с вероятностью 60-80% (в зависимости от силы паттерна)
  - Остальные 20-40% - случайный выбор
- **Приоритет 2**: Если обнаружено преобладание зоны в атаках игрока (>50%)
  - Противник блокирует эту зону с вероятностью 60-80% (в зависимости от силы паттерна)
  - Остальные 20-40% - случайный выбор
- **Если паттернов нет**: Используется полностью случайная стратегия

**При атаке противника (игрок защищается):**
- **Приоритет 1**: Если обнаружена повторяющаяся последовательность блоков игрока
  - Противник атакует в зоны, отличные от блоков игрока, с вероятностью 60-80%
  - Остальные 20-40% - случайный выбор
- **Приоритет 2**: Если обнаружено преобладание зоны в блоках игрока (>50%)
  - Противник атакует в другие зоны (не предпочитаемую игроком) с вероятностью 60-80%
  - Остальные 20-40% - случайный выбор
- **Если паттернов нет**: Используется полностью случайная стратегия

**Конкретные цифры:**
- Минимальное количество раундов для активации: **3**
- Количество хранимых последовательностей: **5** (для атак и блоков отдельно)
- Порог преобладания зоны: **>50%**
- Порог сильного паттерна преобладания: **>70%**
- Минимальное количество повторов последовательности: **2**
- Порог сильного паттерна последовательности: **4+ повтора**
- Вес слабого паттерна: **60%** (40% случайность)
- Вес сильного паттерна: **80%** (20% случайность)

**Примеры работы:**

1. Игрок атакует в голову 8 раз из 10:
   - Обнаружено преобладание зоны "high" (80% - сильный паттерн)
   - Противник блокирует голову с вероятностью 80% в каждом действии
   - Остальные 20% - случайный выбор

2. Игрок повторяет последовательность [high, mid, low] 3 раза подряд:
   - Обнаружена повторяющаяся последовательность (сильный паттерн)
   - Противник блокирует [high, mid, low] с вероятностью 80% в каждом действии
   - Остальные 20% - случайный выбор

3. Игрок защищает тело в 6 из 10 случаев:
   - Обнаружено преобладание зоны "mid" (60% - слабый паттерн)
   - Противник атакует в голову или ноги с вероятностью 60% в каждом действии
   - Остальные 40% - случайный выбор

## Условия победы и поражения

- **Победа**: Здоровье противника достигает 0, здоровье игрока больше 0
- **Поражение**: Здоровье игрока достигает 0, здоровье противника больше 0
- **Ничья**: Здоровье обоих бойцов достигает 0 одновременно — играется дополнительный раунд с 2 HP

## Временные параметры

- Задержка между действиями в одной фазе: 1 секунда
- Задержка между фазами раунда: 2 секунды

Эти задержки обеспечивают комфортный темп игры и возможность восприятия каждого действия.

